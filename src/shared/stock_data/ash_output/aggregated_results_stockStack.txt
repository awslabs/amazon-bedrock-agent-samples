#############################################
Start of  /src/ash_output/work/cdk_report_result.txt
#############################################

starting to investigate ...
found 1 files to scan.  Starting scans ...
>>>>>> begin cdk-nag result for stock_data_stack.yaml >>>>>>
[Error at /cfn-stacks-stock-data-stack-yaml/--src--cfn_stacks--stock_data_stack.yaml/CodeBuildRole] AwsSolutions-IAM5[Resource::*]: The IAM entity contains wildcard permissions and does not have a cdk-nag rule suppression with evidence for those permission. Metadata explaining the evidence (e.g. via supporting links) for wildcard permissions allows for transparency to operators. This is a granular rule that returns individual findings that can be suppressed with 'appliesTo'. The findings are in the format 'Action::<action>' for policy actions and 'Resource::<resource>' for resources. Example: appliesTo: ['Action::s3:*'].

[Error at /cfn-stacks-stock-data-stack-yaml/--src--cfn_stacks--stock_data_stack.yaml/CodeBuildProject] AwsSolutions-CB4: The CodeBuild project does not use an AWS KMS key for encryption. Using an AWS KMS key helps follow the standard security advice of granting least privilege to objects generated by the project.

[Error at /cfn-stacks-stock-data-stack-yaml/--src--cfn_stacks--stock_data_stack.yaml/StockLambdaExecutionRole] AwsSolutions-IAM4[Policy::arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole]: The IAM user, role, or group uses AWS managed policies. An AWSÂ managed policyÂ is a standaloneÂ policyÂ that is created and administered by AWS. Currently, many AWS managed policies do not restrict resource scope. Replace AWS managed policies with system specific (customer) managed policies.This is a granular rule that returns individual findings that can be suppressed with 'appliesTo'. The findings are in the format 'Policy::<policy>' for AWS managed policies. Example: appliesTo: ['Policy::arn:<AWS::Partition>:iam::aws:policy/foo'].

[Error at /cfn-stacks-stock-data-stack-yaml/--src--cfn_stacks--stock_data_stack.yaml/BuildCodeCustomResourceRole] AwsSolutions-IAM5[Resource::*]: The IAM entity contains wildcard permissions and does not have a cdk-nag rule suppression with evidence for those permission. Metadata explaining the evidence (e.g. via supporting links) for wildcard permissions allows for transparency to operators. This is a granular rule that returns individual findings that can be suppressed with 'appliesTo'. The findings are in the format 'Action::<action>' for policy actions and 'Resource::<resource>' for resources. Example: appliesTo: ['Action::s3:*'].

[Error at /cfn-stacks-stock-data-stack-yaml/--src--cfn_stacks--stock_data_stack.yaml/BuildCodeCustomResourceFunction] AwsSolutions-L1: The non-container Lambda function is not configured to use the latest runtime version. Use the latest available runtime for the targeted language to avoid technical debt. Runtimes specific to a language or framework version are deprecated when the version reaches end of life. This rule only applies to non-container Lambda functions.

Found errors
Writing CDK-NAG reports for stock_data_stack.yaml
<<<<<< end cdk-nag result for stock_data_stack.yaml <<<<<<
#############################################
End of  /src/ash_output/work/cdk_report_result.txt
#############################################


#############################################
Start of  /src/ash_output/work/grype_report_result.txt
#############################################

>>>>>> Begin Grype output for /src >>>>>>

[0000]  WARN no explicit name and version provided for directory source, deriving artifact ID from the given path (which is not ideal)
No vulnerabilities found

<<<<<< End Grype output for /src <<<<<<


>>>>>> Begin Grype output for /src/ash_output/work >>>>>>

[0000]  WARN no explicit name and version provided for directory source, deriving artifact ID from the given path (which is not ideal)
No vulnerabilities found

<<<<<< End Grype output for /src/ash_output/work <<<<<<


>>>>>> Begin Syft output for /src >>>>>>

[0000]  WARN no explicit name and version provided for directory source, deriving artifact ID from the given path (which is not ideal)
No packages discovered

<<<<<< End Syft output for /src <<<<<<


>>>>>> Begin Syft output for /src/ash_output/work >>>>>>

[0000]  WARN no explicit name and version provided for directory source, deriving artifact ID from the given path (which is not ideal)
No packages discovered

<<<<<< End Syft output for /src/ash_output/work <<<<<<


>>>>>> Begin Semgrep output for /src >>>>>>

METRICS: Using configs from the Registry (like --config=p/ci) reports pseudonymous rule metrics to semgrep.dev.
To disable Registry rule metrics, use "--metrics=off".
Using configs only from local files (like --config=xyz.yml) does not enable metrics.

More information: https://semgrep.dev/docs/metrics

               
               
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Scan Status â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  Scanning 14 files tracked by git with 1062 Code rules:
                                                                                                                        
  Language      Rules   Files          Origin      Rules                                                                
 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                               
  <multilang>      48      14          Community    1062                                                                
  python          243       1                                                                                           
  yaml             31       1                                                                                           
  dockerfile        5       1                                                                                           
  json              4       1                                                                                           
                                                                                                                        
                
                
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Scan Summary â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Semgrep's file targeting is getting a revamp! This scan wouldn't see any changes. To learn about what will be different after version 1.116.0, visit https://semgrep.dev/docs/kb/semgrep-code/semgrepignore-ignored for the new specification.

âœ… Scan completed successfully.
 â€¢ Findings: 1 (1 blocking)
 â€¢ Rules run: 328
 â€¢ Targets scanned: 14
 â€¢ Parsed lines: ~100.0%
 â€¢ No ignore information available
Ran 328 rules on 14 files: 1 finding.
                  
                  
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1 Code Finding â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                
    /src/docker_files/Dockerfile
   â¯â¯â± dockerfile.security.missing-user.missing-user
          By not specifying a USER, a program in the container may run as 'root'. This is a security hazard.
          If an attacker can control a process running as root, they may have control over the container.   
          Ensure that the last USER in a Dockerfile is a USER other than 'root'.                            
          Details: https://sg.run/Gbvn                                                                      
                                                                                                            
           â–¶â–¶â”† Autofix â–¶ USER non-root CMD [ "lambda_function.lambda_handler" ]
           12â”† CMD [ "lambda_function.lambda_handler" ]


<<<<<< End Semgrep output for /src <<<<<<


>>>>>> Begin Semgrep output for /src/ash_output/work >>>>>>

               
               
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Scan Status â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  Scanning 4 files tracked by git with 1062 Code rules:
  Scanning 4 files with 48 <multilang> rules.
                
                
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Scan Summary â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Semgrep's file targeting is getting a revamp! This scan wouldn't see any changes. To learn about what will be different after version 1.116.0, visit https://semgrep.dev/docs/kb/semgrep-code/semgrepignore-ignored for the new specification.

âœ… Scan completed successfully.
 â€¢ Findings: 0 (0 blocking)
 â€¢ Rules run: 48
 â€¢ Targets scanned: 4
 â€¢ Parsed lines: ~100.0%
 â€¢ No ignore information available
Ran 48 rules on 4 files: 0 findings.
(need more rules? `semgrep login` for additional free Semgrep Registry rules)

If Semgrep missed a finding, please send us feedback to let us know!
See https://semgrep.dev/docs/reporting-false-negatives/

<<<<<< End Semgrep output for /src/ash_output/work <<<<<<

#############################################
End of  /src/ash_output/work/grype_report_result.txt
#############################################


#############################################
Start of  /src/ash_output/work/py_report_result.txt
#############################################
>>>>>> begin identifyipynb output for Jupyter notebook conversion >>>>>>
Looking for Jupyter notebook files


<<<<<< end identifyipynb output for Jupyter notebook conversion <<<<<<
>>>>>> begin bandit result for /src >>>>>>
[main]	INFO	profile include tests: None
[main]	INFO	profile exclude tests: None
[main]	INFO	cli include tests: None
[main]	INFO	cli exclude tests: None
[main]	INFO	running on Python 3.10.16
Run started:2025-04-02 17:08:48.451200

Test results:
	No issues identified.

Code scanned:
	Total lines of code: 159
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 0
		Medium: 0
		High: 0
	Total issues (by confidence):
		Undefined: 0
		Low: 0
		Medium: 0
		High: 0
Files skipped (0):

<<<<<< end bandit result for /src <<<<<<
>>>>>> begin bandit result for /src/ash_output/work >>>>>>
[main]	INFO	profile include tests: None
[main]	INFO	profile exclude tests: None
[main]	INFO	cli include tests: None
[main]	INFO	cli exclude tests: None
[main]	INFO	running on Python 3.10.16
Run started:2025-04-02 17:08:48.653038

Test results:
	No issues identified.

Code scanned:
	Total lines of code: 0
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 0
		Medium: 0
		High: 0
	Total issues (by confidence):
		Undefined: 0
		Low: 0
		Medium: 0
		High: 0
Files skipped (0):

<<<<<< end bandit result for /src/ash_output/work <<<<<<
#############################################
End of  /src/ash_output/work/py_report_result.txt
#############################################


#############################################
Start of  /src/ash_output/work/yaml_report_result.txt
#############################################

>>>>>> Begin yaml scan output for /src >>>>>>

starting to investigate ...
found 2 files to scan.  Starting checkov scans ...
>>>>>> begin checkov result for Dockerfile >>>>>>

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.396 

dockerfile scan results:

Passed checks: 21, Failed checks: 2, Skipped checks: 0

Check: CKV_DOCKER_9: "Ensure that APT isn't used"
	PASSED for resource: /src/docker_files/Dockerfile.
	File: /src/docker_files/Dockerfile:1-12
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-is-not-used
Check: CKV_DOCKER_5: "Ensure update instructions are not use alone in the Dockerfile"
	PASSED for resource: /src/docker_files/Dockerfile.
	File: /src/docker_files/Dockerfile:1-12
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-update-instructions-are-not-used-alone-in-the-dockerfile
Check: CKV_DOCKER_11: "Ensure From Alias are unique for multistage builds."
	PASSED for resource: /src/docker_files/Dockerfile.
	File: /src/docker_files/Dockerfile:1-12
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-from-alias-is-unique-for-multistage-builds
Check: CKV_DOCKER_7: "Ensure the base image uses a non latest version tag"
	PASSED for resource: /src/docker_files/Dockerfile.FROM
	File: /src/docker_files/Dockerfile:2-2
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-base-image-uses-a-non-latest-version-tag
Check: CKV2_DOCKER_1: "Ensure that sudo isn't used"
	PASSED for resource: /src/docker_files/Dockerfile.RUN
	File: /src/docker_files/Dockerfile:6-6
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo
Check: CKV2_DOCKER_14: "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value"
	PASSED for resource: /src/docker_files/Dockerfile.RUN
	File: /src/docker_files/Dockerfile:6-6
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl
Check: CKV2_DOCKER_6: "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environmnet variable"
	PASSED for resource: /src/docker_files/Dockerfile.RUN
	File: /src/docker_files/Dockerfile:6-6
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure
Check: CKV2_DOCKER_16: "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable"
	PASSED for resource: /src/docker_files/Dockerfile.RUN
	File: /src/docker_files/Dockerfile:6-6
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host
Check: CKV2_DOCKER_5: "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environmnet variable"
	PASSED for resource: /src/docker_files/Dockerfile.RUN
	File: /src/docker_files/Dockerfile:6-6
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure
Check: CKV2_DOCKER_17: "Ensure that 'chpasswd' is not used to set or remove passwords"
	PASSED for resource: /src/docker_files/Dockerfile.RUN
	File: /src/docker_files/Dockerfile:6-6
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17
Check: CKV2_DOCKER_12: "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environmnet variable"
	PASSED for resource: /src/docker_files/Dockerfile.RUN
	File: /src/docker_files/Dockerfile:6-6
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl
Check: CKV2_DOCKER_13: "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false"
	PASSED for resource: /src/docker_files/Dockerfile.RUN
	File: /src/docker_files/Dockerfile:6-6
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2
Check: CKV2_DOCKER_4: "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option"
	PASSED for resource: /src/docker_files/Dockerfile.RUN
	File: /src/docker_files/Dockerfile:6-6
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure
Check: CKV2_DOCKER_2: "Ensure that certificate validation isn't disabled with curl"
	PASSED for resource: /src/docker_files/Dockerfile.RUN
	File: /src/docker_files/Dockerfile:6-6
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure
Check: CKV2_DOCKER_15: "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option"
	PASSED for resource: /src/docker_files/Dockerfile.RUN
	File: /src/docker_files/Dockerfile:6-6
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl
Check: CKV2_DOCKER_9: "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option"
	PASSED for resource: /src/docker_files/Dockerfile.RUN
	File: /src/docker_files/Dockerfile:6-6
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed
Check: CKV2_DOCKER_7: "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option"
	PASSED for resource: /src/docker_files/Dockerfile.RUN
	File: /src/docker_files/Dockerfile:6-6
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted
Check: CKV2_DOCKER_3: "Ensure that certificate validation isn't disabled with wget"
	PASSED for resource: /src/docker_files/Dockerfile.RUN
	File: /src/docker_files/Dockerfile:6-6
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure
Check: CKV2_DOCKER_11: "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state"
	PASSED for resource: /src/docker_files/Dockerfile.RUN
	File: /src/docker_files/Dockerfile:6-6
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force
Check: CKV2_DOCKER_8: "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option"
	PASSED for resource: /src/docker_files/Dockerfile.RUN
	File: /src/docker_files/Dockerfile:6-6
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated
Check: CKV2_DOCKER_10: "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options"
	PASSED for resource: /src/docker_files/Dockerfile.RUN
	File: /src/docker_files/Dockerfile:6-6
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed
Check: CKV_DOCKER_3: "Ensure that a user for the container has been created"
	FAILED for resource: /src/docker_files/Dockerfile.
	File: /src/docker_files/Dockerfile:1-12
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-a-user-for-the-container-has-been-created

		1  | # Use the base AWS Lambda Python 3.12 image
		2  | FROM public.ecr.aws/lambda/python:3.12.2024.01.05.15
		3  | 
		4  | # Copy requirements file and install dependencies
		5  | COPY requirements.txt .
		6  | RUN pip install --no-cache-dir -r requirements.txt
		7  | 
		8  | # Copy function code
		9  | COPY lambda_function.py .
		10 | 
		11 | # Set the Lambda handler
		12 | CMD [ "lambda_function.lambda_handler" ]
Check: CKV_DOCKER_2: "Ensure that HEALTHCHECK instructions have been added to container images"
	FAILED for resource: /src/docker_files/Dockerfile.
	File: /src/docker_files/Dockerfile:1-12
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-healthcheck-instructions-have-been-added-to-container-images

		1  | # Use the base AWS Lambda Python 3.12 image
		2  | FROM public.ecr.aws/lambda/python:3.12.2024.01.05.15
		3  | 
		4  | # Copy requirements file and install dependencies
		5  | COPY requirements.txt .
		6  | RUN pip install --no-cache-dir -r requirements.txt
		7  | 
		8  | # Copy function code
		9  | COPY lambda_function.py .
		10 | 
		11 | # Set the Lambda handler
		12 | CMD [ "lambda_function.lambda_handler" ]

<<<<<< end checkov result for Dockerfile <<<<<<
>>>>>> begin checkov result for stock_data_stack.yaml >>>>>>

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.396 

cloudformation scan results:

Passed checks: 31, Failed checks: 13, Skipped checks: 0

Check: CKV_AWS_32: "Ensure ECR policy is not set to public"
	PASSED for resource: AWS::ECR::Repository.StockLambdaECRRepo
	File: /cfn_stacks/stock_data_stack.yaml:6-9
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-1-ecr-repositories-not-public
Check: CKV_AWS_108: "Ensure IAM policies does not allow data exfiltration"
	PASSED for resource: AWS::IAM::Role.CodeBuildRole
	File: /cfn_stacks/stock_data_stack.yaml:11-40
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-data-exfiltration
Check: CKV_AWS_60: "Ensure IAM role allows only specific services or principals to assume it"
	PASSED for resource: AWS::IAM::Role.CodeBuildRole
	File: /cfn_stacks/stock_data_stack.yaml:11-40
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44
Check: CKV_AWS_61: "Ensure AWS IAM policy does not allow assume role permission across all services"
	PASSED for resource: AWS::IAM::Role.CodeBuildRole
	File: /cfn_stacks/stock_data_stack.yaml:11-40
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45
Check: CKV_AWS_62: "Ensure no IAM policies that allow full "*-*" administrative privileges are not created"
	PASSED for resource: AWS::IAM::Role.CodeBuildRole
	File: /cfn_stacks/stock_data_stack.yaml:11-40
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45
Check: CKV_AWS_63: "Ensure no IAM policies documents allow "*" as a statement's actions"
	PASSED for resource: AWS::IAM::Role.CodeBuildRole
	File: /cfn_stacks/stock_data_stack.yaml:11-40
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48
Check: CKV_AWS_110: "Ensure IAM policies does not allow privilege escalation"
	PASSED for resource: AWS::IAM::Role.CodeBuildRole
	File: /cfn_stacks/stock_data_stack.yaml:11-40
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-does-not-allow-privilege-escalation
Check: CKV_AWS_107: "Ensure IAM policies does not allow credentials exposure"
	PASSED for resource: AWS::IAM::Role.CodeBuildRole
	File: /cfn_stacks/stock_data_stack.yaml:11-40
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-credentials-exposure
Check: CKV_AWS_109: "Ensure IAM policies does not allow permissions management without constraints"
	PASSED for resource: AWS::IAM::Role.CodeBuildRole
	File: /cfn_stacks/stock_data_stack.yaml:11-40
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-permissions-management-resource-exposure-without-constraint
Check: CKV_AWS_78: "Ensure that CodeBuild Project encryption is not disabled"
	PASSED for resource: AWS::CodeBuild::Project.CodeBuildProject
	File: /cfn_stacks/stock_data_stack.yaml:42-81
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-30
Check: CKV_AWS_108: "Ensure IAM policies does not allow data exfiltration"
	PASSED for resource: AWS::IAM::Role.StockLambdaExecutionRole
	File: /cfn_stacks/stock_data_stack.yaml:83-95
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-data-exfiltration
Check: CKV_AWS_60: "Ensure IAM role allows only specific services or principals to assume it"
	PASSED for resource: AWS::IAM::Role.StockLambdaExecutionRole
	File: /cfn_stacks/stock_data_stack.yaml:83-95
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44
Check: CKV_AWS_61: "Ensure AWS IAM policy does not allow assume role permission across all services"
	PASSED for resource: AWS::IAM::Role.StockLambdaExecutionRole
	File: /cfn_stacks/stock_data_stack.yaml:83-95
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45
Check: CKV_AWS_110: "Ensure IAM policies does not allow privilege escalation"
	PASSED for resource: AWS::IAM::Role.StockLambdaExecutionRole
	File: /cfn_stacks/stock_data_stack.yaml:83-95
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-does-not-allow-privilege-escalation
Check: CKV_AWS_111: "Ensure IAM policies does not allow write access without constraints"
	PASSED for resource: AWS::IAM::Role.StockLambdaExecutionRole
	File: /cfn_stacks/stock_data_stack.yaml:83-95
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-write-access-without-constraint
Check: CKV_AWS_107: "Ensure IAM policies does not allow credentials exposure"
	PASSED for resource: AWS::IAM::Role.StockLambdaExecutionRole
	File: /cfn_stacks/stock_data_stack.yaml:83-95
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-credentials-exposure
Check: CKV_AWS_109: "Ensure IAM policies does not allow permissions management without constraints"
	PASSED for resource: AWS::IAM::Role.StockLambdaExecutionRole
	File: /cfn_stacks/stock_data_stack.yaml:83-95
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-permissions-management-resource-exposure-without-constraint
Check: CKV_AWS_363: "Ensure Lambda Runtime is not deprecated"
	PASSED for resource: AWS::Lambda::Function.StockLambdaFunction
	File: /cfn_stacks/stock_data_stack.yaml:98-111
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-363
Check: CKV_AWS_45: "Ensure no hard-coded secrets exist in Lambda environment"
	PASSED for resource: AWS::Lambda::Function.StockLambdaFunction
	File: /cfn_stacks/stock_data_stack.yaml:98-111
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-3
Check: CKV_AWS_108: "Ensure IAM policies does not allow data exfiltration"
	PASSED for resource: AWS::IAM::Role.BuildCodeCustomResourceRole
	File: /cfn_stacks/stock_data_stack.yaml:113-138
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-data-exfiltration
Check: CKV_AWS_60: "Ensure IAM role allows only specific services or principals to assume it"
	PASSED for resource: AWS::IAM::Role.BuildCodeCustomResourceRole
	File: /cfn_stacks/stock_data_stack.yaml:113-138
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44
Check: CKV_AWS_61: "Ensure AWS IAM policy does not allow assume role permission across all services"
	PASSED for resource: AWS::IAM::Role.BuildCodeCustomResourceRole
	File: /cfn_stacks/stock_data_stack.yaml:113-138
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45
Check: CKV_AWS_62: "Ensure no IAM policies that allow full "*-*" administrative privileges are not created"
	PASSED for resource: AWS::IAM::Role.BuildCodeCustomResourceRole
	File: /cfn_stacks/stock_data_stack.yaml:113-138
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45
Check: CKV_AWS_63: "Ensure no IAM policies documents allow "*" as a statement's actions"
	PASSED for resource: AWS::IAM::Role.BuildCodeCustomResourceRole
	File: /cfn_stacks/stock_data_stack.yaml:113-138
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48
Check: CKV_AWS_110: "Ensure IAM policies does not allow privilege escalation"
	PASSED for resource: AWS::IAM::Role.BuildCodeCustomResourceRole
	File: /cfn_stacks/stock_data_stack.yaml:113-138
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-does-not-allow-privilege-escalation
Check: CKV_AWS_107: "Ensure IAM policies does not allow credentials exposure"
	PASSED for resource: AWS::IAM::Role.BuildCodeCustomResourceRole
	File: /cfn_stacks/stock_data_stack.yaml:113-138
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-credentials-exposure
Check: CKV_AWS_109: "Ensure IAM policies does not allow permissions management without constraints"
	PASSED for resource: AWS::IAM::Role.BuildCodeCustomResourceRole
	File: /cfn_stacks/stock_data_stack.yaml:113-138
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-permissions-management-resource-exposure-without-constraint
Check: CKV_AWS_363: "Ensure Lambda Runtime is not deprecated"
	PASSED for resource: AWS::Lambda::Function.BuildCodeCustomResourceFunction
	File: /cfn_stacks/stock_data_stack.yaml:140-167
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-363
Check: CKV_AWS_45: "Ensure no hard-coded secrets exist in Lambda environment"
	PASSED for resource: AWS::Lambda::Function.BuildCodeCustomResourceFunction
	File: /cfn_stacks/stock_data_stack.yaml:140-167
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-3
Check: CKV_AWS_364: "Ensure that AWS Lambda function permissions delegated to AWS services are limited by SourceArn or SourceAccount"
	PASSED for resource: AWS::Lambda::Permission.AgentAliasLambdaPermission
	File: /cfn_stacks/stock_data_stack.yaml:175-183
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-364
Check: CKV_AWS_364: "Ensure that AWS Lambda function permissions delegated to AWS services are limited by SourceArn or SourceAccount"
	PASSED for resource: AWS::Lambda::Permission.AgentLambdaPermission
	File: /cfn_stacks/stock_data_stack.yaml:185-193
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-364
Check: CKV_AWS_51: "Ensure ECR Image Tags are immutable"
	FAILED for resource: AWS::ECR::Repository.StockLambdaECRRepo
	File: /cfn_stacks/stock_data_stack.yaml:6-9
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-24

		6 |   StockLambdaECRRepo:
		7 |     Type: AWS::ECR::Repository
		8 |     Properties:
		9 |       RepositoryName: stock-data-tools

Check: CKV_AWS_136: "Ensure that ECR repositories are encrypted using KMS"
	FAILED for resource: AWS::ECR::Repository.StockLambdaECRRepo
	File: /cfn_stacks/stock_data_stack.yaml:6-9
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ecr-repositories-are-encrypted

		6 |   StockLambdaECRRepo:
		7 |     Type: AWS::ECR::Repository
		8 |     Properties:
		9 |       RepositoryName: stock-data-tools

Check: CKV_AWS_163: "Ensure ECR image scanning on push is enabled"
	FAILED for resource: AWS::ECR::Repository.StockLambdaECRRepo
	File: /cfn_stacks/stock_data_stack.yaml:6-9
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-8

		6 |   StockLambdaECRRepo:
		7 |     Type: AWS::ECR::Repository
		8 |     Properties:
		9 |       RepositoryName: stock-data-tools

Check: CKV_AWS_111: "Ensure IAM policies does not allow write access without constraints"
	FAILED for resource: AWS::IAM::Role.CodeBuildRole
	File: /cfn_stacks/stock_data_stack.yaml:11-40
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-write-access-without-constraint

		11 |   CodeBuildRole:
		12 |     Type: AWS::IAM::Role
		13 |     Properties:
		14 |       AssumeRolePolicyDocument:
		15 |         Version: "2012-10-17"
		16 |         Statement:
		17 |           - Effect: Allow
		18 |             Principal:
		19 |               Service: codebuild.amazonaws.com
		20 |             Action: sts:AssumeRole
		21 |       Policies:
		22 |         - PolicyName: CodeBuildECRPolicy
		23 |           PolicyDocument:
		24 |             Version: "2012-10-17"
		25 |             Statement:
		26 |               - Effect: Allow
		27 |                 Action:
		28 |                   - ecr:GetAuthorizationToken
		29 |                   - ecr:BatchCheckLayerAvailability
		30 |                   - ecr:CompleteLayerUpload
		31 |                   - ecr:InitiateLayerUpload
		32 |                   - ecr:PutImage
		33 |                   - ecr:UploadLayerPart
		34 |                 Resource: "*"
		35 |               - Effect: Allow
		36 |                 Action:
		37 |                   - logs:CreateLogGroup
		38 |                   - logs:CreateLogStream
		39 |                   - logs:PutLogEvents
		40 |                 Resource: "*"

Check: CKV_AWS_117: "Ensure that AWS Lambda function is configured inside a VPC"
	FAILED for resource: AWS::Lambda::Function.StockLambdaFunction
	File: /cfn_stacks/stock_data_stack.yaml:98-111
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1

		98  |   StockLambdaFunction:
		99  |     Type: AWS::Lambda::Function
		100 |     Properties:
		101 |       FunctionName: stock_data_tools
		102 |       PackageType: Image
		103 |       Code:
		104 |         ImageUri: !Sub "${AWS::AccountId}.dkr.ecr.${AWS::Region}.amazonaws.com/stock-data-tools:latest"
		105 |       Role: !GetAtt StockLambdaExecutionRole.Arn
		106 |       Timeout: 600
		107 |       MemorySize: 512
		108 |       Environment:
		109 |         Variables:
		110 |           LOG_LEVEL: INFO
		111 |     DependsOn: BuildCodeCustomResource

Check: CKV_AWS_116: "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)"
	FAILED for resource: AWS::Lambda::Function.StockLambdaFunction
	File: /cfn_stacks/stock_data_stack.yaml:98-111
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		98  |   StockLambdaFunction:
		99  |     Type: AWS::Lambda::Function
		100 |     Properties:
		101 |       FunctionName: stock_data_tools
		102 |       PackageType: Image
		103 |       Code:
		104 |         ImageUri: !Sub "${AWS::AccountId}.dkr.ecr.${AWS::Region}.amazonaws.com/stock-data-tools:latest"
		105 |       Role: !GetAtt StockLambdaExecutionRole.Arn
		106 |       Timeout: 600
		107 |       MemorySize: 512
		108 |       Environment:
		109 |         Variables:
		110 |           LOG_LEVEL: INFO
		111 |     DependsOn: BuildCodeCustomResource

Check: CKV_AWS_173: "Check encryption settings for Lambda environment variable"
	FAILED for resource: AWS::Lambda::Function.StockLambdaFunction
	File: /cfn_stacks/stock_data_stack.yaml:98-111
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5

		98  |   StockLambdaFunction:
		99  |     Type: AWS::Lambda::Function
		100 |     Properties:
		101 |       FunctionName: stock_data_tools
		102 |       PackageType: Image
		103 |       Code:
		104 |         ImageUri: !Sub "${AWS::AccountId}.dkr.ecr.${AWS::Region}.amazonaws.com/stock-data-tools:latest"
		105 |       Role: !GetAtt StockLambdaExecutionRole.Arn
		106 |       Timeout: 600
		107 |       MemorySize: 512
		108 |       Environment:
		109 |         Variables:
		110 |           LOG_LEVEL: INFO
		111 |     DependsOn: BuildCodeCustomResource

Check: CKV_AWS_115: "Ensure that AWS Lambda function is configured for function-level concurrent execution limit"
	FAILED for resource: AWS::Lambda::Function.StockLambdaFunction
	File: /cfn_stacks/stock_data_stack.yaml:98-111
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		98  |   StockLambdaFunction:
		99  |     Type: AWS::Lambda::Function
		100 |     Properties:
		101 |       FunctionName: stock_data_tools
		102 |       PackageType: Image
		103 |       Code:
		104 |         ImageUri: !Sub "${AWS::AccountId}.dkr.ecr.${AWS::Region}.amazonaws.com/stock-data-tools:latest"
		105 |       Role: !GetAtt StockLambdaExecutionRole.Arn
		106 |       Timeout: 600
		107 |       MemorySize: 512
		108 |       Environment:
		109 |         Variables:
		110 |           LOG_LEVEL: INFO
		111 |     DependsOn: BuildCodeCustomResource

Check: CKV_AWS_111: "Ensure IAM policies does not allow write access without constraints"
	FAILED for resource: AWS::IAM::Role.BuildCodeCustomResourceRole
	File: /cfn_stacks/stock_data_stack.yaml:113-138
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-write-access-without-constraint

		113 |   BuildCodeCustomResourceRole:
		114 |     Type: AWS::IAM::Role
		115 |     Properties:
		116 |       AssumeRolePolicyDocument:
		117 |         Version: "2012-10-17"
		118 |         Statement:
		119 |           - Effect: Allow
		120 |             Principal:
		121 |               Service: lambda.amazonaws.com
		122 |             Action: sts:AssumeRole
		123 |       Policies:
		124 |         - PolicyName: TriggerCodeBuild
		125 |           PolicyDocument:
		126 |             Version: "2012-10-17"
		127 |             Statement:
		128 |               - Effect: Allow
		129 |                 Action:
		130 |                   - codebuild:StartBuild
		131 |                   - codebuild:BatchGetBuilds
		132 |                 Resource: "*"
		133 |               - Effect: Allow
		134 |                 Action:
		135 |                   - logs:CreateLogGroup
		136 |                   - logs:CreateLogStream
		137 |                   - logs:PutLogEvents
		138 |                 Resource: "*"

Check: CKV_AWS_117: "Ensure that AWS Lambda function is configured inside a VPC"
	FAILED for resource: AWS::Lambda::Function.BuildCodeCustomResourceFunction
	File: /cfn_stacks/stock_data_stack.yaml:140-167
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1

		140 |   BuildCodeCustomResourceFunction:
		141 |     Type: AWS::Lambda::Function
		142 |     Properties:
		143 |       Handler: index.handler
		144 |       Role: !GetAtt BuildCodeCustomResourceRole.Arn
		145 |       Timeout: 300
		146 |       Runtime: python3.12
		147 |       Code:
		148 |         ZipFile: |
		149 |           import boto3
		150 |           import os
		151 |           import time
		152 |           import cfnresponse
		153 | 
		154 |           def handler(event, context):
		155 |               client = boto3.client("codebuild")
		156 |               if event['RequestType'] == 'Create':
		157 |                   build = client.start_build(projectName=os.environ['PROJECT'])
		158 |                   build_id = build['build']['id']
		159 |                   while True:
		160 |                       status = client.batch_get_builds(ids=[build_id])['builds'][0]['buildStatus']
		161 |                       if status in ['SUCCEEDED', 'FAILED', 'FAULT', 'TIMED_OUT', 'STOPPED']:
		162 |                           break
		163 |                       time.sleep(10)
		164 |               cfnresponse.send(event, context, cfnresponse.SUCCESS, {})
		165 |       Environment:
		166 |         Variables:
		167 |           PROJECT: !Ref CodeBuildProject

Check: CKV_AWS_116: "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)"
	FAILED for resource: AWS::Lambda::Function.BuildCodeCustomResourceFunction
	File: /cfn_stacks/stock_data_stack.yaml:140-167
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		140 |   BuildCodeCustomResourceFunction:
		141 |     Type: AWS::Lambda::Function
		142 |     Properties:
		143 |       Handler: index.handler
		144 |       Role: !GetAtt BuildCodeCustomResourceRole.Arn
		145 |       Timeout: 300
		146 |       Runtime: python3.12
		147 |       Code:
		148 |         ZipFile: |
		149 |           import boto3
		150 |           import os
		151 |           import time
		152 |           import cfnresponse
		153 | 
		154 |           def handler(event, context):
		155 |               client = boto3.client("codebuild")
		156 |               if event['RequestType'] == 'Create':
		157 |                   build = client.start_build(projectName=os.environ['PROJECT'])
		158 |                   build_id = build['build']['id']
		159 |                   while True:
		160 |                       status = client.batch_get_builds(ids=[build_id])['builds'][0]['buildStatus']
		161 |                       if status in ['SUCCEEDED', 'FAILED', 'FAULT', 'TIMED_OUT', 'STOPPED']:
		162 |                           break
		163 |                       time.sleep(10)
		164 |               cfnresponse.send(event, context, cfnresponse.SUCCESS, {})
		165 |       Environment:
		166 |         Variables:
		167 |           PROJECT: !Ref CodeBuildProject

Check: CKV_AWS_173: "Check encryption settings for Lambda environment variable"
	FAILED for resource: AWS::Lambda::Function.BuildCodeCustomResourceFunction
	File: /cfn_stacks/stock_data_stack.yaml:140-167
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5

		140 |   BuildCodeCustomResourceFunction:
		141 |     Type: AWS::Lambda::Function
		142 |     Properties:
		143 |       Handler: index.handler
		144 |       Role: !GetAtt BuildCodeCustomResourceRole.Arn
		145 |       Timeout: 300
		146 |       Runtime: python3.12
		147 |       Code:
		148 |         ZipFile: |
		149 |           import boto3
		150 |           import os
		151 |           import time
		152 |           import cfnresponse
		153 | 
		154 |           def handler(event, context):
		155 |               client = boto3.client("codebuild")
		156 |               if event['RequestType'] == 'Create':
		157 |                   build = client.start_build(projectName=os.environ['PROJECT'])
		158 |                   build_id = build['build']['id']
		159 |                   while True:
		160 |                       status = client.batch_get_builds(ids=[build_id])['builds'][0]['buildStatus']
		161 |                       if status in ['SUCCEEDED', 'FAILED', 'FAULT', 'TIMED_OUT', 'STOPPED']:
		162 |                           break
		163 |                       time.sleep(10)
		164 |               cfnresponse.send(event, context, cfnresponse.SUCCESS, {})
		165 |       Environment:
		166 |         Variables:
		167 |           PROJECT: !Ref CodeBuildProject

Check: CKV_AWS_115: "Ensure that AWS Lambda function is configured for function-level concurrent execution limit"
	FAILED for resource: AWS::Lambda::Function.BuildCodeCustomResourceFunction
	File: /cfn_stacks/stock_data_stack.yaml:140-167
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		140 |   BuildCodeCustomResourceFunction:
		141 |     Type: AWS::Lambda::Function
		142 |     Properties:
		143 |       Handler: index.handler
		144 |       Role: !GetAtt BuildCodeCustomResourceRole.Arn
		145 |       Timeout: 300
		146 |       Runtime: python3.12
		147 |       Code:
		148 |         ZipFile: |
		149 |           import boto3
		150 |           import os
		151 |           import time
		152 |           import cfnresponse
		153 | 
		154 |           def handler(event, context):
		155 |               client = boto3.client("codebuild")
		156 |               if event['RequestType'] == 'Create':
		157 |                   build = client.start_build(projectName=os.environ['PROJECT'])
		158 |                   build_id = build['build']['id']
		159 |                   while True:
		160 |                       status = client.batch_get_builds(ids=[build_id])['builds'][0]['buildStatus']
		161 |                       if status in ['SUCCEEDED', 'FAILED', 'FAULT', 'TIMED_OUT', 'STOPPED']:
		162 |                           break
		163 |                       time.sleep(10)
		164 |               cfnresponse.send(event, context, cfnresponse.SUCCESS, {})
		165 |       Environment:
		166 |         Variables:
		167 |           PROJECT: !Ref CodeBuildProject


<<<<<< end checkov result for stock_data_stack.yaml <<<<<<
found 1 files to scan.  Starting cfn_nag scans ...
>>>>>> begin cfn_nag_scan result for stock_data_stack.yaml >>>>>>
------------------------------------------------------------
/src/cfn_stacks/stock_data_stack.yaml
------------------------------------------------------------------------------------------------------------------------
[33m| WARN W32[0m
[33m|[0m
[33m| Resource: ["CodeBuildProject"][0m
[33m| Line Numbers: [43][0m
[33m|[0m
[33m| CodeBuild project should specify an EncryptionKey value[0m
------------------------------------------------------------
[33m| WARN W79[0m
[33m|[0m
[33m| Resource: ["StockLambdaECRRepo"][0m
[33m| Line Numbers: [7][0m
[33m|[0m
[33m| ECR Repository should have ScanOnPush enabled[0m
------------------------------------------------------------
[33m| WARN W11[0m
[33m|[0m
[33m| Resource: ["CodeBuildRole", "BuildCodeCustomResourceRole"][0m
[33m| Line Numbers: [12, 114][0m
[33m|[0m
[33m| IAM role should not allow * resource on its permissions policy[0m
------------------------------------------------------------
[33m| WARN W89[0m
[33m|[0m
[33m| Resource: ["StockLambdaFunction", "BuildCodeCustomResourceFunction"][0m
[33m| Line Numbers: [99, 141][0m
[33m|[0m
[33m| Lambda functions should be deployed inside a VPC[0m
------------------------------------------------------------
[33m| WARN W92[0m
[33m|[0m
[33m| Resource: ["StockLambdaFunction", "BuildCodeCustomResourceFunction"][0m
[33m| Line Numbers: [99, 141][0m
[33m|[0m
[33m| Lambda functions should define ReservedConcurrentExecutions to reserve simultaneous executions[0m
------------------------------------------------------------
[33m| WARN W28[0m
[33m|[0m
[33m| Resource: ["StockLambdaECRRepo", "StockLambdaExecutionRole"][0m
[33m| Line Numbers: [7, 84][0m
[33m|[0m
[33m| Resource found with an explicit name, this disallows updates that require replacement of this resource[0m

Failures count: 0
Warnings count: 10
<<<<<< end cfn_nag_scan result for stock_data_stack.yaml <<<<<<

<<<<<< End yaml scan output for /src <<<<<<


>>>>>> Begin yaml scan output for /src/ash_output/work >>>>>>

starting to investigate ...
found 0 files to scan.  Skipping checkov scans.
found 0 files to scan.  Skipping cfn_nag scans.

<<<<<< End yaml scan output for /src/ash_output/work <<<<<<

#############################################
End of  /src/ash_output/work/yaml_report_result.txt
#############################################


